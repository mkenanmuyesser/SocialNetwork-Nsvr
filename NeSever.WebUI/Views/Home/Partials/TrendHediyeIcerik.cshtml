@model List<NeSever.Common.Models.Urun.UrunIcerikVM>

<style type="text/css">
    .trenditem {
        display: flex;
        margin: 10px;
        justify-content: center;
        align-items: center;
    }
</style>

<div class="col col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
    <div class="row">
        <div class="owl-carousel owl-theme trend">
            @for (int i = 0; i < Model.Count; i++)
            {
                <div class="item">
                    @{ var urun = Model[i]; }
                    <div class="trenditem">
                        <div class="shop-product-item" style="min-height: 320px;">
                            <div class="product-thumb" style="background-color:transparent;">
                                <a href="/Hediye/Detay/@urun.UrunId" style="width:100%;text-align:center;">
                                    <img src="@urun.ResimUrl" alt="product" style="width:auto;height:250px;">
                                </a>
                            </div>
                            <div class="product-content">
                                <div class="block-title">
                                    <a href="/Hediye/Detay/@urun.UrunId" class="product-category">@urun.MarkaAdi</a>
                                    <a href="/Hediye/Detay/@urun.UrunId" class="h6">@urun.UrunAdi</a>
                                </div>
                                <div class="block-price">
                                    @if (urun.SatilabilirUrun && urun.Fiyat > 0)
                                    {
                                        <a href="javascript:;" onclick="alisverisSepetineEkle('@urun.UrunId');" class="in-cart" style="opacity: 50 !important; background-color: #38a9ff !important; top:-80px;" title="AlışVeriş Sepetine Ekle">
                                            <svg class="olymp-shopping-bag-icon">
                                                <title>AlışVeriş Sepetine Ekle</title>
                                                <use xlink:href="#olymp-shopping-bag-icon">
                                                    <title>AlışVeriş Sepetine Ekle</title>
                                                </use>
                                            </svg>
                                        </a>
                                    }

                                    <a href="javascript:;" onclick="hediyeSepetineEkle('@urun.UrunId', '@urun.HediyeSepetindekiUrunAdeti');" class="in-cart" style="opacity: 50 !important; background-color: #ff5e3a !important; top: -30px;">
                                        <svg class="olymp-like-post-icon"><use xlink:href="#olymp-like-post-icon"></use></svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    @{i++;}

                    @if (i < Model.Count)
                    {
                        {
                            urun = Model[i];
                        }
                        <div class="trenditem">
                            <div class="shop-product-item" style="min-height: 320px;">
                                <div class="product-thumb" style="background-color:transparent;">
                                    <a href="/Hediye/Detay/@urun.UrunId" style="width:100%;text-align:center;">
                                        <img src="@urun.ResimUrl" alt="product" style="width:auto;height:250px;">
                                    </a>
                                </div>
                                <div class="product-content">
                                    <div class="block-title">
                                        <a href="/Hediye/Detay/@urun.UrunId" class="product-category">@urun.MarkaAdi</a>
                                        <a href="/Hediye/Detay/@urun.UrunId" class="h6">@urun.UrunAdi</a>
                                    </div>
                                    <div class="block-price">
                                        @if (urun.SatilabilirUrun && urun.Fiyat > 0)
                                        {
                                            <a href="javascript:;" onclick="alisverisSepetineEkle('@urun.UrunId');" class="in-cart" style="opacity: 50 !important; background-color: #38a9ff !important; top:-80px;" title="AlışVeriş Sepetine Ekle">
                                                <svg class="olymp-shopping-bag-icon">
                                                    <title>AlışVeriş Sepetine Ekle</title>
                                                    <use xlink:href="#olymp-shopping-bag-icon">
                                                        <title>AlışVeriş Sepetine Ekle</title>
                                                    </use>
                                                </svg>
                                            </a>
                                        }

                                        <a href="javascript:;" onclick="hediyeSepetineEkle('@urun.UrunId', '@urun.HediyeSepetindekiUrunAdeti');" class="in-cart" style="opacity: 50 !important; background-color: #ff5e3a !important; top: -30px;">
                                            <svg class="olymp-like-post-icon"><use xlink:href="#olymp-like-post-icon"></use></svg>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @{i++;}

                    @if (i < Model.Count)
                    {
                        {
                            urun = Model[i];
                        }
                        <div class="trenditem">
                            <div class="shop-product-item" style="min-height: 320px;">
                                <div class="product-thumb" style="background-color:transparent;">
                                    <a href="/Hediye/Detay/@urun.UrunId" style="width:100%;text-align:center;">
                                        <img src="@urun.ResimUrl" alt="product" style="width:auto;height:250px;">
                                    </a>
                                </div>
                                <div class="product-content">
                                    <div class="block-title">
                                        <a href="/Hediye/Detay/@urun.UrunId" class="product-category">@urun.MarkaAdi</a>
                                        <a href="/Hediye/Detay/@urun.UrunId" class="h6">@urun.UrunAdi</a>
                                    </div>
                                    <div class="block-price">
                                        @if (urun.SatilabilirUrun && urun.Fiyat > 0)
                                        {
                                            <a href="javascript:;" onclick="alisverisSepetineEkle('@urun.UrunId');" class="in-cart" style="opacity: 50 !important; background-color: #38a9ff !important; top:-80px;" title="AlışVeriş Sepetine Ekle">
                                                <svg class="olymp-shopping-bag-icon">
                                                    <title>AlışVeriş Sepetine Ekle</title>
                                                    <use xlink:href="#olymp-shopping-bag-icon">
                                                        <title>AlışVeriş Sepetine Ekle</title>
                                                    </use>
                                                </svg>
                                            </a>
                                        }

                                        <a href="javascript:;" onclick="hediyeSepetineEkle('@urun.UrunId', '@urun.HediyeSepetindekiUrunAdeti');" class="in-cart" style="opacity: 50 !important; background-color: #ff5e3a !important; top: -30px;">
                                            <svg class="olymp-like-post-icon"><use xlink:href="#olymp-like-post-icon"></use></svg>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @{i++;}

                    @if (i < Model.Count)
                    {
                        {
                            urun = Model[i];
                        }
                        <div class="trenditem">
                            <div class="shop-product-item" style="min-height: 320px;">
                                <div class="product-thumb" style="background-color:transparent;">
                                    <a href="/Hediye/Detay/@urun.UrunId" style="width:100%;text-align:center;">
                                        <img src="@urun.ResimUrl" alt="product" style="width:auto;height:250px;">
                                    </a>
                                </div>
                                <div class="product-content">
                                    <div class="block-title">
                                        <a href="/Hediye/Detay/@urun.UrunId" class="product-category">@urun.MarkaAdi</a>
                                        <a href="/Hediye/Detay/@urun.UrunId" class="h6">@urun.UrunAdi</a>
                                    </div>
                                    <div class="block-price">
                                        @if (urun.SatilabilirUrun && urun.Fiyat > 0)
                                        {
                                            <a href="javascript:;" onclick="alisverisSepetineEkle('@urun.UrunId');" class="in-cart" style="opacity: 50 !important; background-color: #38a9ff !important; top:-80px;" title="AlışVeriş Sepetine Ekle">
                                                <svg class="olymp-shopping-bag-icon">
                                                    <title>AlışVeriş Sepetine Ekle</title>
                                                    <use xlink:href="#olymp-shopping-bag-icon">
                                                        <title>AlışVeriş Sepetine Ekle</title>
                                                    </use>
                                                </svg>
                                            </a>
                                        }

                                        <a href="javascript:;" onclick="hediyeSepetineEkle('@urun.UrunId', '@urun.HediyeSepetindekiUrunAdeti');" class="in-cart" style="opacity: 50 !important; background-color: #ff5e3a !important; top: -30px;">
                                            <svg class="olymp-like-post-icon"><use xlink:href="#olymp-like-post-icon"></use></svg>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
        </div>
    </div>
</div>

<partial name="~/Views/Shared/Partials/UyeHediye.cshtml" />
<partial name="~/Views/Shared/Partials/UyeAlisveris.cshtml" />

<script type="text/javascript">
    $(document).ready(function () {
        $('.trend').owlCarousel({
            loop: true,
            margin: 10,
            responsiveClass: true,
            responsive: {
                0: {
                    items: 1,
                    nav: false,
                    loop: true,
                },
                600: {
                    items: 2,
                    nav: false,
                    loop: true,
                },
                1000: {
                    items: 3,
                    nav: false,
                    loop: true,
                    margin: 20
                },
                1200: {
                    items: 4,
                    nav: false,
                    loop: true,
                    margin: 20
                }
            }
        })
    })

    function hediyeSepetineEkle(id, adet) {
        $.ajax({
            url: "/Hediye/KullaniciHediyeEkle/" + id,
            type: "GET",
            dataType: 'json',
            contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
            success: function (data) {
                if (data.error == true) {
                    if (data.operation == "show") {
                        hediyeSepetiShowModal(adet);
                    }
                    else if (data.operation == "message") {
                        Swal.fire({
                            icon: 'warning',
                            title: 'Uyarı!',
                            text: data.message,
                            confirmButtonText: "Tamam"
                        })
                    }
                }
                else {
                    Swal.fire({
                        icon: 'success',
                        title: 'Evvet!',
                        text: "Hediye sepetinize eklendi.",
                        confirmButtonText: "Tamam"
                    })
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                console.log("hata!");
            }
        });
    }

    function hediyeSepetiShowModal(adet) {
        $('#hediyeSepetiToplamUrunSayisi').html(adet);
        $('#hediyeEkleModal').modal('show');
    }

    function alisverisSepetineEkle(id) {
        var sendData = { UrunId: id, Adet: 1 };

        $.ajax({
            url: "/Sepet/SepetUrunEkle",
            type: "POST",
            dataType: 'json',
            data: sendData,
            success: function (data) {
                if (data.error == true) {
                    if (data.operation == "show") {
                        alisverisSepetiShowModal();
                    }
                    else if (data.operation == "message") {
                        Swal.fire({
                            icon: 'warning',
                            title: 'Uyarı!',
                            text: data.message,
                            confirmButtonText: "Tamam"
                        })
                    }
                }
                else {
                    $("#headerSepetUrunSayisi").empty();
                    $("#headerMobilSepetUrunSayisi").empty();
                    $("#headerSepetUrunSayisi").html(data.recordsTotal);
                    $("#headerMobilSepetUrunSayisi").html(data.recordsTotal);

                    Swal.fire({
                        icon: 'success',
                        title: 'Evvet!',
                        text: "Alışveriş sepetinize eklendi.",
                        confirmButtonText: "Tamam"
                    })
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                console.log("hata!");
            }
        });
    }

    function alisverisSepetiShowModal() {
        $('#uyeAlisverisModal').modal('show');
    }
</script>